<html>
<!-- <meta name="viewport" content="width = device-width"> -->

<head>
    <script>
    var attachTouchListeners = true;
    var timestamp;
    var clickCounts = {"none": 0, "manipulation": 0, "auto": 0};

    function setup() {
        bindTouchAndClickHandlers(document.getElementById("none"), handleTouchEnd, handleSyntheticClick);
        bindTouchAndClickHandlers(document.getElementById("manipulation"), handleTouchEnd, handleSyntheticClick);
        bindTouchAndClickHandlers(document.getElementById("auto"), handleTouchEnd, handleSyntheticClick);
    }

    function bindTouchAndClickHandlers(element, ontouchend, onclick) {
        if (attachTouchListeners)
            element.addEventListener("touchend", ontouchend, false);

        element.addEventListener("click", onclick, false);
    }

    function handleTouchEnd(event) {
        event.target.style.backgroundColor = "#FF2222";
        timestamp = Number(new Date());
    }

    function handleSyntheticClick(event) {
        clickCounts[event.target.id]++;
        event.target.textContent = "Click count: " + clickCounts[event.target.id];
        if (attachTouchListeners) {
            var delay = Number(new Date()) - timestamp;
            document.getElementById("delay-log").textContent = "Delay: " + delay + " ms";
            event.target.style.backgroundColor = "#22FF22";
        }
    }
    </script>

    <style>
    button {
        width: 60%;
        height: 160px;
        border-radius: 10px;
        background-color: #22FF22;
        margin-bottom: 10px;
        font-size: 20px;
    }

    #none {
        -webkit-touch-action: none;
        touch-action: none;
    }

    #manipulation {
        -webkit-touch-action: manipulation;
        touch-action: manipulation;
    }
    </style>
</head>

<body onload="setup()">
    <!-- <p>The top button has <code>-webkit-touch-action: manipulation</code> while the bottom one doesn't. Double-tapping in the top button should generate two click events, and should not cause us to zoom in. However, double tapping in the second button should still trigger zoom and should not generate any clicks. There should also be the normal ~350ms delay when tapping on the second button.</p> -->
    <h2>With <code>-webkit-touch-action: none</code></h2>
    <button id="none">Click count: 0</button>
    <h2>With <code>-webkit-touch-action: manipulation</code></h2>
    <button id="manipulation">Click count: 0</button>
    <h2>With <code>-webkit-touch-action: auto</code></h2>
    <button id="auto">Click count: 0</button>
    <h1 id="delay-log">Delay:</h1>
</body>

</html>
